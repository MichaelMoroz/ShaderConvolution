vec3 pack2vec3(vec3 a, vec3 b) 
{
    uvec3 packed = uvec3(packHalf2x16(vec2(a.x,b.x)), packHalf2x16(vec2(a.y,b.y)), packHalf2x16(vec2(a.z,b.z)));
    return vec3(uintBitsToFloat(packed.x), uintBitsToFloat(packed.y), uintBitsToFloat(packed.z));
}

void unpack2vec3(vec3 packed, out vec3 a, out vec3 b) 
{
    uvec3 unpacked = uvec3(floatBitsToUint(packed.x), floatBitsToUint(packed.y), floatBitsToUint(packed.z));
    vec2 unpackedA = unpackHalf2x16(unpacked.x);
    vec2 unpackedB = unpackHalf2x16(unpacked.y);
    vec2 unpackedC = unpackHalf2x16(unpacked.z);
    a = vec3(unpackedA.x, unpackedB.x, unpackedC.x);
    b = vec3(unpackedA.y, unpackedB.y, unpackedC.y);
}

//first pass of separable convolution
void mainImage( out vec4 fragColor, in vec2 fragCoord )
{    
    //The first 2 columns of the U matrix:
    float U1[257] = float[](
        -7.557296344273823e-09,     -7.876148527818927e-08,     -2.3117979596094795e-07,     -4.6914155456992363e-07,     -7.962351863561828e-07,     -1.2158569096862385e-06,     -1.73137192423984e-06,     -2.3461842283002694e-06,     -3.063775668624977e-06,     -3.887729909453427e-06,     -4.821750977079177e-06,     -5.869676926977158e-06,     -7.0354932213690655e-06,     -8.323343642568621e-06,     -9.737541866572847e-06,     -1.1282582589143565e-05,     -1.296315283073975e-05,     -1.4784143428122506e-05,     -1.6750661194356675e-05,     -1.8868041776592815e-05,     -2.1141862578623146e-05,     -2.3577956813496412e-05,     -2.6182428763773486e-05,     -2.8961668826155482e-05,     -3.19223709448007e-05,     -3.507154991021651e-05,     -3.8416560434431325e-05,     -4.1965117712114906e-05,     -4.572531857965874e-05,     -4.970566483964957e-05,     -5.391508803223462e-05,     -5.8362975911312206e-05,     -6.305920069598252e-05,     -6.801414959265162e-05,     -7.323875747411767e-05,     -7.874454198128607e-05,     -8.454364126638481e-05,     -9.064885460837994e-05,     -9.70736861541115e-05,     -0.00010383239206403088,     -0.00011094003136964075,     -0.00011841252088117362,     -0.00012626669451910085,     -0.00013452036748220727,     -0.00014319240570872507,     -0.00015230280113599675,     -0.00016187275331635382,     -0.00017192475799399502,     -0.00018248270342032322,     -0.0001935719750563917,     -0.0002052195695767992,     -0.00021745421912632148,     -0.00023030652687740992,     -0.00024380911520966136,     -0.0002579967876345579,     -0.0002729067060756482,     -0.00028857858522984115,     -0.00030505490592909695,     -0.00032238114944675006,     -0.0003406060553522691,     -0.00035978190569166,     -0.0003799648383069163,     -0.00040121519309561015,     -0.0004235978951050413,     -0.00044718287883896613,     -0.0004720455592991103,     -0.0004982673553056492,     -0.0005259362721790776,     -0.0005551475514238436,     -0.0005860043963696145,     -0.0006186187842269617,     -0.0006531123762904234,     -0.000689617540357378,     -0.0007282785011662933,     -0.0007692526377838233,     -0.0008127119495306639,     -0.0008588447161577431,     -0.000907857382078767,     -0.0009599767000016091,     -0.0010154521755436758,     -0.0010745588620684698,     -0.001137600564372823,     -0.0012049135208846331,     -0.001276870647949287,     -0.0013538864463342782,     -0.0014364226907244365,     -0.0015249950483367013,     -0.0016201808040860533,     -0.0017226279088993234,     -0.0018330656165747136,     -0.0019523170359852465,     -0.0020813140030855235,     -0.0022211147757790982,     -0.00237292518079984,     -0.002538124003987464,     -0.002718293625332086,     -0.0029152571739400786,     -0.0031311238375717836,     -0.003368344437075814,     -0.003629780010503165,     -0.003918787005245062,     -0.004239323835275993,     -0.004596085148844993,     -0.004994672351370317,     -0.005441812007524935,     -0.005945638108146458,     -0.006516060443573302,     -0.0071652504193862685,     -0.007908289063681344,     -0.008764042068807385,     -0.00975635732456618,     -0.010915727903530209,     -0.012281638652115748,     -0.013905936175421282,     -0.015857763491345687,     -0.018230943198151384,     -0.02115529233405898,     -0.02481443415607389,     -0.029474694208065796,     -0.03553359196587875,     -0.043604367113415345,     -0.05466967458531213,     -0.07037409178092902,     -0.0936064551954588,     -0.12969481008408512,     -0.1887589793394499,     -0.28852141207015086,     -0.44002348591634544,     -0.5426946241198759,     -0.44002348591634544,     -0.28852141207015086,     -0.1887589793394499,     -0.12969481008408512,     -0.0936064551954588,     -0.07037409178092902,     -0.05466967458531213,     -0.043604367113415345,     -0.03553359196587875,     -0.029474694208065796,     -0.02481443415607389,     -0.02115529233405898,     -0.018230943198151384,     -0.015857763491345687,     -0.013905936175421282,     -0.012281638652115748,     -0.010915727903530209,     -0.00975635732456618,     -0.008764042068807385,     -0.007908289063681344,     -0.0071652504193862685,     -0.006516060443573302,     -0.005945638108146458,     -0.005441812007524935,     -0.004994672351370317,     -0.004596085148844993,     -0.004239323835275993,     -0.003918787005245062,     -0.003629780010503165,     -0.003368344437075814,     -0.0031311238375717836,     -0.0029152571739400786,     -0.002718293625332086,     -0.002538124003987464,     -0.00237292518079984,     -0.0022211147757790982,     -0.0020813140030855235,     -0.0019523170359852465,     -0.0018330656165747136,     -0.0017226279088993234,     -0.0016201808040860533,     -0.0015249950483367013,     -0.0014364226907244365,     -0.0013538864463342782,     -0.001276870647949287,     -0.0012049135208846331,     -0.001137600564372823,     -0.0010745588620684698,     -0.0010154521755436758,     -0.0009599767000016091,     -0.000907857382078767,     -0.0008588447161577431,     -0.0008127119495306639,     -0.0007692526377838233,     -0.0007282785011662933,     -0.000689617540357378,     -0.0006531123762904234,     -0.0006186187842269617,     -0.0005860043963696145,     -0.0005551475514238436,     -0.0005259362721790776,     -0.0004982673553056492,     -0.0004720455592991103,     -0.00044718287883896613,     -0.0004235978951050413,     -0.00040121519309561015,     -0.0003799648383069163,     -0.00035978190569166,     -0.0003406060553522691,     -0.00032238114944675006,     -0.00030505490592909695,     -0.00028857858522984115,     -0.0002729067060756482,     -0.0002579967876345579,     -0.00024380911520966136,     -0.00023030652687740992,     -0.00021745421912632148,     -0.0002052195695767992,     -0.0001935719750563917,     -0.00018248270342032322,     -0.00017192475799399502,     -0.00016187275331635382,     -0.00015230280113599675,     -0.00014319240570872507,     -0.00013452036748220727,     -0.00012626669451910085,     -0.00011841252088117362,     -0.00011094003136964075,     -0.00010383239206403088,     -9.70736861541115e-05,     -9.064885460837994e-05,     -8.454364126638481e-05,     -7.874454198128607e-05,     -7.323875747411767e-05,     -6.801414959265162e-05,     -6.305920069598252e-05,     -5.8362975911312206e-05,     -5.391508803223462e-05,     -4.970566483964957e-05,     -4.572531857965874e-05,     -4.1965117712114906e-05,     -3.8416560434431325e-05,     -3.507154991021651e-05,     -3.19223709448007e-05,     -2.8961668826155482e-05,     -2.6182428763773486e-05,     -2.3577956813496412e-05,     -2.1141862578623146e-05,     -1.8868041776592815e-05,     -1.6750661194356675e-05,     -1.4784143428122506e-05,     -1.296315283073975e-05,     -1.1282582589143565e-05,     -9.737541866572847e-06,     -8.323343642568621e-06,     -7.0354932213690655e-06,     -5.869676926977158e-06,     -4.821750977079177e-06,     -3.887729909453427e-06,     -3.063775668624977e-06,     -2.3461842283002694e-06,     -1.73137192423984e-06,     -1.2158569096862387e-06,     -7.962351863561829e-07,     -4.691415545699213e-07,     -2.3117979596017633e-07,     -7.8761485167858e-08,     -7.557296412354428e-09 
    );
    float U2[257] = float[](
        1.6412360082096455e-08,     3.2914933434380345e-07,     1.1550160091688966e-06,     2.5714777790106225e-06,     4.628925854428833e-06,     7.367629336428769e-06,     1.082309307096904e-05,     1.5028391465324231e-05,     2.0015433240935637e-05,     2.5815666623632176e-05,     3.246057862360027e-05,     3.998199138566115e-05,     4.841233954980865e-05,     5.778483091657827e-05,     6.813361998816154e-05,     7.949394466300957e-05,     9.190225065961285e-05,     0.00010539630196571649,     0.00012001529624661094,     0.00013579998459398583,     0.00015279276587253863,     0.00017103779980446817,     0.00019058113997674233,     0.0002114708219241536,     0.00023375701739031346,     0.0002574921414324234,     0.00028273099268654475,     0.00030953091057383527,     0.0003379519066867227,     0.0003680568347950445,     0.00039991156341246347,     0.0004335851571994606,     0.00046915006480686576,     0.0005066823288493557,     0.0005462618064523957,     0.0005879724047946236,     0.0006319023333137112,     0.0006781443739799577,     0.000726796171172532,     0.0007779605428378728,     0.0008317458147698613,     0.000888266180028888,     0.0009476420857138404,     0.0010100006495197549,     0.0010754761087570428,     0.0011442103047788017,     0.0012163532059487005,     0.0012920634719953271,     0.001371509067434322,     0.0014548679232323956,     0.0015423286540555098,     0.0016340913362798122,     0.0017303683518956562,     0.0018313853103441575,     0.0019373820464619273,     0.002048613707454106,     0.0021653519397282577,     0.0022878861867060172,     0.0024165251008331948,     0.002551598090695724,     0.0026934570195705776,     0.00284247805986858,     0.002999063734042183,     0.003163645158479496,     0.0033366845067965764,     0.0035186777329282446,     0.0037101575678913762,     0.00391169683629211,     0.004123912124633704,     0.004347467844924636,     0.004583080748452401,     0.004831524938258636,     0.005093637455245601,     0.005370324502462114,     0.00566256840323682,     0.005971435383299221,     0.006298084298770044,     0.00664377643657213,     0.0070098865444543955,     0.007397915268182398,     0.007809503202646164,     0.008246446803914724,     0.008710716442999433,     0.00920447694105124,     0.009730110978413645,     0.01029024584543317,     0.010887784090168846,     0.011525938719620975,     0.012208273741967576,     0.012938750989982348,     0.013721784354352935,     0.014562302789070967,     0.015465823734641159,     0.01643853895673354,     0.017487415234886255,     0.018620312877934673,     0.01984612572048427,     0.021174947104290735,     0.02261826741735941,     0.0241892101121751,     0.02590281483294827,     0.027776378450663847,     0.029829867564107097,     0.0320864195384041,     0.03457295362385624,     0.03732091937034101,     0.04036721670080492,     0.04375533089952864,     0.047536736574700054,     0.05177263721596955,     0.05653612031748739,     0.06191481932057273,     0.06801417578275795,     0.07496137186421183,     0.08290991765996478,     0.09204464777122806,     0.10258632112601661,     0.11479370143145669,     0.1289579208707398,     0.14537666545809763,     0.16427814596067788,     0.1856208892020639,     0.20858135144799128,     0.23023480610412358,     0.2421041226542675,     0.22124982984721095,     0.11154807909064726,     -0.16541226700943432,     -0.4026322820569403,     -0.16541226700943432,     0.11154807909064726,     0.22124982984721095,     0.2421041226542675,     0.23023480610412358,     0.20858135144799128,     0.1856208892020639,     0.16427814596067788,     0.14537666545809763,     0.1289579208707398,     0.11479370143145669,     0.10258632112601661,     0.09204464777122806,     0.08290991765996478,     0.07496137186421183,     0.06801417578275795,     0.06191481932057273,     0.05653612031748739,     0.05177263721596955,     0.047536736574700054,     0.04375533089952864,     0.04036721670080492,     0.03732091937034101,     0.03457295362385624,     0.0320864195384041,     0.029829867564107097,     0.027776378450663847,     0.02590281483294827,     0.0241892101121751,     0.02261826741735941,     0.021174947104290735,     0.01984612572048427,     0.018620312877934673,     0.017487415234886255,     0.01643853895673354,     0.015465823734641159,     0.014562302789070967,     0.013721784354352935,     0.012938750989982348,     0.012208273741967576,     0.011525938719620975,     0.010887784090168846,     0.01029024584543317,     0.009730110978413645,     0.00920447694105124,     0.008710716442999433,     0.008246446803914724,     0.007809503202646164,     0.007397915268182398,     0.0070098865444543955,     0.00664377643657213,     0.006298084298770044,     0.005971435383299221,     0.00566256840323682,     0.005370324502462114,     0.005093637455245601,     0.004831524938258636,     0.004583080748452401,     0.004347467844924636,     0.004123912124633704,     0.00391169683629211,     0.0037101575678913762,     0.0035186777329282446,     0.0033366845067965764,     0.003163645158479496,     0.002999063734042183,     0.00284247805986858,     0.0026934570195705776,     0.002551598090695724,     0.0024165251008331948,     0.0022878861867060172,     0.0021653519397282577,     0.002048613707454106,     0.0019373820464619273,     0.0018313853103441575,     0.0017303683518956562,     0.0016340913362798122,     0.0015423286540555098,     0.0014548679232323956,     0.001371509067434322,     0.0012920634719953271,     0.0012163532059487005,     0.0011442103047788017,     0.0010754761087570428,     0.0010100006495197549,     0.0009476420857138404,     0.000888266180028888,     0.0008317458147698613,     0.0007779605428378728,     0.000726796171172532,     0.0006781443739799577,     0.0006319023333137112,     0.0005879724047946236,     0.0005462618064523957,     0.0005066823288493557,     0.00046915006480686576,     0.0004335851571994606,     0.00039991156341246347,     0.0003680568347950445,     0.0003379519066867227,     0.00030953091057383527,     0.00028273099268654475,     0.0002574921414324234,     0.00023375701739031346,     0.0002114708219241536,     0.00019058113997674233,     0.00017103779980446817,     0.00015279276587253863,     0.00013579998459398583,     0.00012001529624661094,     0.00010539630196571649,     9.190225065961285e-05,     7.949394466300957e-05,     6.813361998816154e-05,     5.778483091657827e-05,     4.841233954980865e-05,     3.998199138566115e-05,     3.246057862360027e-05,     2.5815666623632176e-05,     2.0015433240935637e-05,     1.5028391465324231e-05,     1.0823093070969042e-05,     7.367629336428769e-06,     4.628925854428805e-06,     2.571477779001723e-06,     1.155016009156483e-06,     3.2914933466327955e-07,     1.641236033572888e-08 
    );
    //The first 2 rows of the V matrix:
    float V1[257] = float[](
        -7.557296412354437e-09,     -7.876148544472272e-08,     -2.3117979594533544e-07,     -4.6914155456999817e-07,     -7.962351863561862e-07,     -1.2158569096862438e-06,     -1.731371924239848e-06,     -2.3461842283002813e-06,     -3.063775668624993e-06,     -3.887729909453448e-06,     -4.8217509770792015e-06,     -5.8696769269771874e-06,     -7.035493221369101e-06,     -8.32334364256866e-06,     -9.737541866572901e-06,     -1.1282582589143624e-05,     -1.2963152830739818e-05,     -1.4784143428122583e-05,     -1.675066119435676e-05,     -1.8868041776592923e-05,     -2.1141862578623268e-05,     -2.3577956813496548e-05,     -2.6182428763773636e-05,     -2.8961668826155642e-05,     -3.192237094480087e-05,     -3.50715499102167e-05,     -3.841656043443153e-05,     -4.196511771211514e-05,     -4.5725318579659e-05,     -4.970566483964984e-05,     -5.3915088032234884e-05,     -5.836297591131254e-05,     -6.305920069598286e-05,     -6.8014149592652e-05,     -7.323875747411808e-05,     -7.874454198128653e-05,     -8.454364126638527e-05,     -9.064885460838047e-05,     -9.707368615411205e-05,     -0.00010383239206403147,     -0.00011094003136964141,     -0.00011841252088117427,     -0.0001262666945191015,     -0.00013452036748220803,     -0.00014319240570872589,     -0.00015230280113599765,     -0.00016187275331635477,     -0.00017192475799399602,     -0.00018248270342032422,     -0.00019357197505639277,     -0.00020521956957680033,     -0.00021745421912632273,     -0.00023030652687741122,     -0.00024380911520966274,     -0.00025799678763455933,     -0.0002729067060756499,     -0.00028857858522984283,     -0.0003050549059290988,     -0.00032238114944675174,     -0.0003406060553522711,     -0.00035978190569166196,     -0.0003799648383069184,     -0.00040121519309561254,     -0.00042359789510504364,     -0.0004471828788389687,     -0.000472045559299113,     -0.0004982673553056519,     -0.0005259362721790804,     -0.0005551475514238468,     -0.000586004396369618,     -0.0006186187842269654,     -0.0006531123762904271,     -0.0006896175403573818,     -0.0007282785011662974,     -0.0007692526377838273,     -0.000812711949530668,     -0.0008588447161577481,     -0.000907857382078772,     -0.0009599767000016143,     -0.0010154521755436814,     -0.0010745588620684758,     -0.0011376005643728292,     -0.00120491352088464,     -0.0012768706479492937,     -0.0013538864463342852,     -0.0014364226907244448,     -0.0015249950483367093,     -0.0016201808040860618,     -0.0017226279088993323,     -0.0018330656165747238,     -0.0019523170359852565,     -0.0020813140030855343,     -0.00222111477577911,     -0.0023729251807998526,     -0.0025381240039874767,     -0.0027182936253321,     -0.0029152571739400925,     -0.0031311238375717997,     -0.0033683444370758305,     -0.0036297800105031834,     -0.003918787005245081,     -0.004239323835276013,     -0.004596085148845014,     -0.004994672351370339,     -0.005441812007524961,     -0.0059456381081464844,     -0.006516060443573333,     -0.0071652504193863015,     -0.007908289063681377,     -0.00876404206880742,     -0.009756357324566223,     -0.010915727903530258,     -0.012281638652115795,     -0.013905936175421336,     -0.015857763491345746,     -0.01823094319815145,     -0.021155292334059047,     -0.024814434156073963,     -0.0294746942080659,     -0.035533591965878894,     -0.043604367113415525,     -0.05466967458531236,     -0.07037409178092931,     -0.09360645519545911,     -0.12969481008408545,     -0.18875897933945018,     -0.28852141207015103,     -0.44002348591634527,     -0.5426946241198755,     -0.44002348591634527,     -0.28852141207015103,     -0.18875897933945018,     -0.12969481008408545,     -0.09360645519545911,     -0.07037409178092931,     -0.05466967458531236,     -0.043604367113415525,     -0.035533591965878894,     -0.0294746942080659,     -0.024814434156073963,     -0.021155292334059047,     -0.01823094319815145,     -0.015857763491345746,     -0.013905936175421336,     -0.012281638652115795,     -0.010915727903530258,     -0.009756357324566223,     -0.00876404206880742,     -0.007908289063681377,     -0.0071652504193863015,     -0.006516060443573333,     -0.0059456381081464844,     -0.005441812007524961,     -0.004994672351370339,     -0.004596085148845014,     -0.004239323835276013,     -0.003918787005245081,     -0.0036297800105031834,     -0.0033683444370758305,     -0.0031311238375717997,     -0.0029152571739400925,     -0.0027182936253321,     -0.0025381240039874767,     -0.0023729251807998526,     -0.00222111477577911,     -0.0020813140030855343,     -0.0019523170359852565,     -0.0018330656165747238,     -0.0017226279088993323,     -0.0016201808040860618,     -0.0015249950483367093,     -0.0014364226907244448,     -0.0013538864463342852,     -0.0012768706479492937,     -0.00120491352088464,     -0.0011376005643728292,     -0.0010745588620684758,     -0.0010154521755436814,     -0.0009599767000016143,     -0.000907857382078772,     -0.0008588447161577481,     -0.000812711949530668,     -0.0007692526377838273,     -0.0007282785011662974,     -0.0006896175403573818,     -0.0006531123762904271,     -0.0006186187842269654,     -0.000586004396369618,     -0.0005551475514238468,     -0.0005259362721790804,     -0.0004982673553056519,     -0.000472045559299113,     -0.0004471828788389687,     -0.00042359789510504364,     -0.00040121519309561254,     -0.0003799648383069184,     -0.00035978190569166196,     -0.0003406060553522711,     -0.00032238114944675174,     -0.0003050549059290988,     -0.00028857858522984283,     -0.0002729067060756499,     -0.00025799678763455933,     -0.00024380911520966274,     -0.00023030652687741122,     -0.00021745421912632273,     -0.00020521956957680033,     -0.00019357197505639277,     -0.00018248270342032422,     -0.00017192475799399602,     -0.00016187275331635477,     -0.00015230280113599765,     -0.00014319240570872589,     -0.00013452036748220803,     -0.0001262666945191015,     -0.00011841252088117427,     -0.00011094003136964141,     -0.00010383239206403147,     -9.707368615411205e-05,     -9.064885460838047e-05,     -8.454364126638527e-05,     -7.874454198128653e-05,     -7.323875747411808e-05,     -6.8014149592652e-05,     -6.305920069598286e-05,     -5.836297591131254e-05,     -5.3915088032234884e-05,     -4.970566483964984e-05,     -4.5725318579659e-05,     -4.196511771211514e-05,     -3.841656043443153e-05,     -3.50715499102167e-05,     -3.192237094480087e-05,     -2.8961668826155642e-05,     -2.6182428763773636e-05,     -2.3577956813496548e-05,     -2.1141862578623268e-05,     -1.8868041776592923e-05,     -1.675066119435676e-05,     -1.4784143428122583e-05,     -1.2963152830739818e-05,     -1.1282582589143624e-05,     -9.737541866572901e-06,     -8.32334364256866e-06,     -7.035493221369101e-06,     -5.8696769269771874e-06,     -4.8217509770792015e-06,     -3.887729909453448e-06,     -3.063775668624993e-06,     -2.3461842283002813e-06,     -1.7313719242398478e-06,     -1.215856909686244e-06,     -7.962351863561862e-07,     -4.6914155456992316e-07,     -2.311797959601771e-07,     -7.876148516785817e-08,     -7.557296412354435e-09 
    );
    float V2[257] = float[](
        1.6412360335728894e-08,     3.291493340523699e-07,     1.1550160093909412e-06,     2.57147777896205e-06,     4.628925854429158e-06,     7.3676293364287445e-06,     1.0823093070969005e-05,     1.5028391465324175e-05,     2.001543324093557e-05,     2.581566662363208e-05,     3.246057862360013e-05,     3.9981991385661006e-05,     4.841233954980847e-05,     5.7784830916578043e-05,     6.813361998816124e-05,     7.949394466300925e-05,     9.190225065961247e-05,     0.00010539630196571603,     0.00012001529624661044,     0.00013579998459398526,     0.00015279276587253795,     0.0001710377998044675,     0.0001905811399767416,     0.00021147082192415263,     0.00023375701739031246,     0.0002574921414324223,     0.00028273099268654356,     0.0003095309105738339,     0.00033795190668672105,     0.0003680568347950429,     0.00039991156341246173,     0.0004335851571994586,     0.00046915006480686364,     0.0005066823288493534,     0.0005462618064523932,     0.000587972404794621,     0.0006319023333137083,     0.0006781443739799545,     0.0007267961711725288,     0.0007779605428378693,     0.0008317458147698575,     0.000888266180028884,     0.000947642085713836,     0.00101000064951975,     0.0010754761087570378,     0.0011442103047787963,     0.0012163532059486946,     0.0012920634719953208,     0.0013715090674343156,     0.0014548679232323886,     0.0015423286540555026,     0.0016340913362798044,     0.0017303683518956486,     0.001831385310344149,     0.0019373820464619184,     0.0020486137074540974,     0.002165351939728247,     0.002287886186706007,     0.0024165251008331826,     0.0025515980906957126,     0.0026934570195705663,     0.0028424780598685674,     0.0029990637340421697,     0.003163645158479481,     0.0033366845067965617,     0.0035186777329282294,     0.003710157567891359,     0.003911696836292094,     0.004123912124633684,     0.004347467844924616,     0.00458308074845238,     0.004831524938258613,     0.005093637455245579,     0.005370324502462089,     0.005662568403236794,     0.005971435383299195,     0.006298084298770016,     0.006643776436572101,     0.0070098865444543626,     0.007397915268182369,     0.007809503202646132,     0.008246446803914691,     0.008710716442999396,     0.009204476941051197,     0.009730110978413607,     0.010290245845433124,     0.010887784090168799,     0.011525938719620925,     0.01220827374196752,     0.012938750989982295,     0.013721784354352878,     0.014562302789070912,     0.015465823734641098,     0.016438538956733473,     0.01748741523488618,     0.0186203128779346,     0.01984612572048419,     0.021174947104290655,     0.02261826741735932,     0.024189210112175022,     0.025902814832948172,     0.027776378450663743,     0.02982986756410699,     0.03208641953840397,     0.034572953623856116,     0.03732091937034088,     0.04036721670080478,     0.04375533089952847,     0.04753673657469991,     0.05177263721596938,     0.05653612031748724,     0.06191481932057253,     0.06801417578275772,     0.0749613718642116,     0.08290991765996454,     0.09204464777122782,     0.10258632112601632,     0.11479370143145634,     0.12895792087073957,     0.14537666545809735,     0.16427814596067775,     0.18562088920206377,     0.20858135144799123,     0.2302348061041235,     0.24210412265426767,     0.22124982984721098,     0.11154807909064735,     -0.1654122670094351,     -0.40263228205694107,     -0.1654122670094351,     0.11154807909064735,     0.22124982984721098,     0.24210412265426767,     0.2302348061041235,     0.20858135144799123,     0.18562088920206377,     0.16427814596067775,     0.14537666545809735,     0.12895792087073957,     0.11479370143145634,     0.10258632112601632,     0.09204464777122782,     0.08290991765996454,     0.0749613718642116,     0.06801417578275772,     0.06191481932057253,     0.05653612031748724,     0.05177263721596938,     0.04753673657469991,     0.04375533089952847,     0.04036721670080478,     0.03732091937034088,     0.034572953623856116,     0.03208641953840397,     0.02982986756410699,     0.027776378450663743,     0.025902814832948172,     0.024189210112175022,     0.02261826741735932,     0.021174947104290655,     0.01984612572048419,     0.0186203128779346,     0.01748741523488618,     0.016438538956733473,     0.015465823734641098,     0.014562302789070912,     0.013721784354352878,     0.012938750989982295,     0.01220827374196752,     0.011525938719620925,     0.010887784090168799,     0.010290245845433124,     0.009730110978413607,     0.009204476941051197,     0.008710716442999396,     0.008246446803914691,     0.007809503202646132,     0.007397915268182369,     0.0070098865444543626,     0.006643776436572101,     0.006298084298770016,     0.005971435383299195,     0.005662568403236794,     0.005370324502462089,     0.005093637455245579,     0.004831524938258613,     0.00458308074845238,     0.004347467844924616,     0.004123912124633684,     0.003911696836292094,     0.003710157567891359,     0.0035186777329282294,     0.0033366845067965617,     0.003163645158479481,     0.0029990637340421697,     0.0028424780598685674,     0.0026934570195705663,     0.0025515980906957126,     0.0024165251008331826,     0.002287886186706007,     0.002165351939728247,     0.0020486137074540974,     0.0019373820464619184,     0.001831385310344149,     0.0017303683518956486,     0.0016340913362798044,     0.0015423286540555026,     0.0014548679232323886,     0.0013715090674343156,     0.0012920634719953208,     0.0012163532059486946,     0.0011442103047787963,     0.0010754761087570378,     0.00101000064951975,     0.000947642085713836,     0.000888266180028884,     0.0008317458147698575,     0.0007779605428378693,     0.0007267961711725288,     0.0006781443739799545,     0.0006319023333137083,     0.000587972404794621,     0.0005462618064523932,     0.0005066823288493534,     0.00046915006480686364,     0.0004335851571994586,     0.00039991156341246173,     0.0003680568347950429,     0.00033795190668672105,     0.0003095309105738339,     0.00028273099268654356,     0.0002574921414324223,     0.00023375701739031246,     0.00021147082192415263,     0.0001905811399767416,     0.0001710377998044675,     0.00015279276587253795,     0.00013579998459398526,     0.00012001529624661044,     0.00010539630196571603,     9.190225065961247e-05,     7.949394466300925e-05,     6.813361998816124e-05,     5.7784830916578043e-05,     4.841233954980847e-05,     3.9981991385661006e-05,     3.246057862360013e-05,     2.581566662363208e-05,     2.001543324093557e-05,     1.5028391465324175e-05,     1.0823093070969005e-05,     7.3676293364287445e-06,     4.628925854428792e-06,     2.5714777790017168e-06,     1.1550160091564806e-06,     3.291493346632791e-07,     1.64123603357289e-08 
    );
    //The first 2 singular values:
    float S[2] = float[](
        0.045983058370594285,     0.007889879937601593 
    );
    //center of the convolution
    int Nc = 128;

    //do a convolution in the x direction on iChannel0
    vec3 sum1 = vec3(0.0);
    vec3 sum2 = vec3(0.0);
    ivec2 coord = ivec2(fragCoord);
    for (int i = -Nc; i < Nc; i++) 
    {
        //use texelFetch to get the pixel at the current index
        vec4 pixel = texelFetch(iChannel0, ivec2(coord.x + i, coord.y), 0);
        vec3 pcolor = pixel.xyz/(pixel.w+1e-6);

        sum1 += pcolor * S[0] * U1[i + Nc];
        sum2 += pcolor * S[1] * U2[i + Nc];
    }

    //write the sum packed to the output
    vec4 outColor = vec4(pack2vec3(sum1, sum2), 1.0);
}

//second pass: do the convolution in the y direction
//and write the result to the output    
void mainImage( out vec4 fragColor, in vec2 fragCoord )
{
    //The first 2 columns of the U matrix:
    float U1[257] = float[](
        -7.557296344273823e-09,     -7.876148527818927e-08,     -2.3117979596094795e-07,     -4.6914155456992363e-07,     -7.962351863561828e-07,     -1.2158569096862385e-06,     -1.73137192423984e-06,     -2.3461842283002694e-06,     -3.063775668624977e-06,     -3.887729909453427e-06,     -4.821750977079177e-06,     -5.869676926977158e-06,     -7.0354932213690655e-06,     -8.323343642568621e-06,     -9.737541866572847e-06,     -1.1282582589143565e-05,     -1.296315283073975e-05,     -1.4784143428122506e-05,     -1.6750661194356675e-05,     -1.8868041776592815e-05,     -2.1141862578623146e-05,     -2.3577956813496412e-05,     -2.6182428763773486e-05,     -2.8961668826155482e-05,     -3.19223709448007e-05,     -3.507154991021651e-05,     -3.8416560434431325e-05,     -4.1965117712114906e-05,     -4.572531857965874e-05,     -4.970566483964957e-05,     -5.391508803223462e-05,     -5.8362975911312206e-05,     -6.305920069598252e-05,     -6.801414959265162e-05,     -7.323875747411767e-05,     -7.874454198128607e-05,     -8.454364126638481e-05,     -9.064885460837994e-05,     -9.70736861541115e-05,     -0.00010383239206403088,     -0.00011094003136964075,     -0.00011841252088117362,     -0.00012626669451910085,     -0.00013452036748220727,     -0.00014319240570872507,     -0.00015230280113599675,     -0.00016187275331635382,     -0.00017192475799399502,     -0.00018248270342032322,     -0.0001935719750563917,     -0.0002052195695767992,     -0.00021745421912632148,     -0.00023030652687740992,     -0.00024380911520966136,     -0.0002579967876345579,     -0.0002729067060756482,     -0.00028857858522984115,     -0.00030505490592909695,     -0.00032238114944675006,     -0.0003406060553522691,     -0.00035978190569166,     -0.0003799648383069163,     -0.00040121519309561015,     -0.0004235978951050413,     -0.00044718287883896613,     -0.0004720455592991103,     -0.0004982673553056492,     -0.0005259362721790776,     -0.0005551475514238436,     -0.0005860043963696145,     -0.0006186187842269617,     -0.0006531123762904234,     -0.000689617540357378,     -0.0007282785011662933,     -0.0007692526377838233,     -0.0008127119495306639,     -0.0008588447161577431,     -0.000907857382078767,     -0.0009599767000016091,     -0.0010154521755436758,     -0.0010745588620684698,     -0.001137600564372823,     -0.0012049135208846331,     -0.001276870647949287,     -0.0013538864463342782,     -0.0014364226907244365,     -0.0015249950483367013,     -0.0016201808040860533,     -0.0017226279088993234,     -0.0018330656165747136,     -0.0019523170359852465,     -0.0020813140030855235,     -0.0022211147757790982,     -0.00237292518079984,     -0.002538124003987464,     -0.002718293625332086,     -0.0029152571739400786,     -0.0031311238375717836,     -0.003368344437075814,     -0.003629780010503165,     -0.003918787005245062,     -0.004239323835275993,     -0.004596085148844993,     -0.004994672351370317,     -0.005441812007524935,     -0.005945638108146458,     -0.006516060443573302,     -0.0071652504193862685,     -0.007908289063681344,     -0.008764042068807385,     -0.00975635732456618,     -0.010915727903530209,     -0.012281638652115748,     -0.013905936175421282,     -0.015857763491345687,     -0.018230943198151384,     -0.02115529233405898,     -0.02481443415607389,     -0.029474694208065796,     -0.03553359196587875,     -0.043604367113415345,     -0.05466967458531213,     -0.07037409178092902,     -0.0936064551954588,     -0.12969481008408512,     -0.1887589793394499,     -0.28852141207015086,     -0.44002348591634544,     -0.5426946241198759,     -0.44002348591634544,     -0.28852141207015086,     -0.1887589793394499,     -0.12969481008408512,     -0.0936064551954588,     -0.07037409178092902,     -0.05466967458531213,     -0.043604367113415345,     -0.03553359196587875,     -0.029474694208065796,     -0.02481443415607389,     -0.02115529233405898,     -0.018230943198151384,     -0.015857763491345687,     -0.013905936175421282,     -0.012281638652115748,     -0.010915727903530209,     -0.00975635732456618,     -0.008764042068807385,     -0.007908289063681344,     -0.0071652504193862685,     -0.006516060443573302,     -0.005945638108146458,     -0.005441812007524935,     -0.004994672351370317,     -0.004596085148844993,     -0.004239323835275993,     -0.003918787005245062,     -0.003629780010503165,     -0.003368344437075814,     -0.0031311238375717836,     -0.0029152571739400786,     -0.002718293625332086,     -0.002538124003987464,     -0.00237292518079984,     -0.0022211147757790982,     -0.0020813140030855235,     -0.0019523170359852465,     -0.0018330656165747136,     -0.0017226279088993234,     -0.0016201808040860533,     -0.0015249950483367013,     -0.0014364226907244365,     -0.0013538864463342782,     -0.001276870647949287,     -0.0012049135208846331,     -0.001137600564372823,     -0.0010745588620684698,     -0.0010154521755436758,     -0.0009599767000016091,     -0.000907857382078767,     -0.0008588447161577431,     -0.0008127119495306639,     -0.0007692526377838233,     -0.0007282785011662933,     -0.000689617540357378,     -0.0006531123762904234,     -0.0006186187842269617,     -0.0005860043963696145,     -0.0005551475514238436,     -0.0005259362721790776,     -0.0004982673553056492,     -0.0004720455592991103,     -0.00044718287883896613,     -0.0004235978951050413,     -0.00040121519309561015,     -0.0003799648383069163,     -0.00035978190569166,     -0.0003406060553522691,     -0.00032238114944675006,     -0.00030505490592909695,     -0.00028857858522984115,     -0.0002729067060756482,     -0.0002579967876345579,     -0.00024380911520966136,     -0.00023030652687740992,     -0.00021745421912632148,     -0.0002052195695767992,     -0.0001935719750563917,     -0.00018248270342032322,     -0.00017192475799399502,     -0.00016187275331635382,     -0.00015230280113599675,     -0.00014319240570872507,     -0.00013452036748220727,     -0.00012626669451910085,     -0.00011841252088117362,     -0.00011094003136964075,     -0.00010383239206403088,     -9.70736861541115e-05,     -9.064885460837994e-05,     -8.454364126638481e-05,     -7.874454198128607e-05,     -7.323875747411767e-05,     -6.801414959265162e-05,     -6.305920069598252e-05,     -5.8362975911312206e-05,     -5.391508803223462e-05,     -4.970566483964957e-05,     -4.572531857965874e-05,     -4.1965117712114906e-05,     -3.8416560434431325e-05,     -3.507154991021651e-05,     -3.19223709448007e-05,     -2.8961668826155482e-05,     -2.6182428763773486e-05,     -2.3577956813496412e-05,     -2.1141862578623146e-05,     -1.8868041776592815e-05,     -1.6750661194356675e-05,     -1.4784143428122506e-05,     -1.296315283073975e-05,     -1.1282582589143565e-05,     -9.737541866572847e-06,     -8.323343642568621e-06,     -7.0354932213690655e-06,     -5.869676926977158e-06,     -4.821750977079177e-06,     -3.887729909453427e-06,     -3.063775668624977e-06,     -2.3461842283002694e-06,     -1.73137192423984e-06,     -1.2158569096862387e-06,     -7.962351863561829e-07,     -4.691415545699213e-07,     -2.3117979596017633e-07,     -7.8761485167858e-08,     -7.557296412354428e-09 
    );
    float U2[257] = float[](
        1.6412360082096455e-08,     3.2914933434380345e-07,     1.1550160091688966e-06,     2.5714777790106225e-06,     4.628925854428833e-06,     7.367629336428769e-06,     1.082309307096904e-05,     1.5028391465324231e-05,     2.0015433240935637e-05,     2.5815666623632176e-05,     3.246057862360027e-05,     3.998199138566115e-05,     4.841233954980865e-05,     5.778483091657827e-05,     6.813361998816154e-05,     7.949394466300957e-05,     9.190225065961285e-05,     0.00010539630196571649,     0.00012001529624661094,     0.00013579998459398583,     0.00015279276587253863,     0.00017103779980446817,     0.00019058113997674233,     0.0002114708219241536,     0.00023375701739031346,     0.0002574921414324234,     0.00028273099268654475,     0.00030953091057383527,     0.0003379519066867227,     0.0003680568347950445,     0.00039991156341246347,     0.0004335851571994606,     0.00046915006480686576,     0.0005066823288493557,     0.0005462618064523957,     0.0005879724047946236,     0.0006319023333137112,     0.0006781443739799577,     0.000726796171172532,     0.0007779605428378728,     0.0008317458147698613,     0.000888266180028888,     0.0009476420857138404,     0.0010100006495197549,     0.0010754761087570428,     0.0011442103047788017,     0.0012163532059487005,     0.0012920634719953271,     0.001371509067434322,     0.0014548679232323956,     0.0015423286540555098,     0.0016340913362798122,     0.0017303683518956562,     0.0018313853103441575,     0.0019373820464619273,     0.002048613707454106,     0.0021653519397282577,     0.0022878861867060172,     0.0024165251008331948,     0.002551598090695724,     0.0026934570195705776,     0.00284247805986858,     0.002999063734042183,     0.003163645158479496,     0.0033366845067965764,     0.0035186777329282446,     0.0037101575678913762,     0.00391169683629211,     0.004123912124633704,     0.004347467844924636,     0.004583080748452401,     0.004831524938258636,     0.005093637455245601,     0.005370324502462114,     0.00566256840323682,     0.005971435383299221,     0.006298084298770044,     0.00664377643657213,     0.0070098865444543955,     0.007397915268182398,     0.007809503202646164,     0.008246446803914724,     0.008710716442999433,     0.00920447694105124,     0.009730110978413645,     0.01029024584543317,     0.010887784090168846,     0.011525938719620975,     0.012208273741967576,     0.012938750989982348,     0.013721784354352935,     0.014562302789070967,     0.015465823734641159,     0.01643853895673354,     0.017487415234886255,     0.018620312877934673,     0.01984612572048427,     0.021174947104290735,     0.02261826741735941,     0.0241892101121751,     0.02590281483294827,     0.027776378450663847,     0.029829867564107097,     0.0320864195384041,     0.03457295362385624,     0.03732091937034101,     0.04036721670080492,     0.04375533089952864,     0.047536736574700054,     0.05177263721596955,     0.05653612031748739,     0.06191481932057273,     0.06801417578275795,     0.07496137186421183,     0.08290991765996478,     0.09204464777122806,     0.10258632112601661,     0.11479370143145669,     0.1289579208707398,     0.14537666545809763,     0.16427814596067788,     0.1856208892020639,     0.20858135144799128,     0.23023480610412358,     0.2421041226542675,     0.22124982984721095,     0.11154807909064726,     -0.16541226700943432,     -0.4026322820569403,     -0.16541226700943432,     0.11154807909064726,     0.22124982984721095,     0.2421041226542675,     0.23023480610412358,     0.20858135144799128,     0.1856208892020639,     0.16427814596067788,     0.14537666545809763,     0.1289579208707398,     0.11479370143145669,     0.10258632112601661,     0.09204464777122806,     0.08290991765996478,     0.07496137186421183,     0.06801417578275795,     0.06191481932057273,     0.05653612031748739,     0.05177263721596955,     0.047536736574700054,     0.04375533089952864,     0.04036721670080492,     0.03732091937034101,     0.03457295362385624,     0.0320864195384041,     0.029829867564107097,     0.027776378450663847,     0.02590281483294827,     0.0241892101121751,     0.02261826741735941,     0.021174947104290735,     0.01984612572048427,     0.018620312877934673,     0.017487415234886255,     0.01643853895673354,     0.015465823734641159,     0.014562302789070967,     0.013721784354352935,     0.012938750989982348,     0.012208273741967576,     0.011525938719620975,     0.010887784090168846,     0.01029024584543317,     0.009730110978413645,     0.00920447694105124,     0.008710716442999433,     0.008246446803914724,     0.007809503202646164,     0.007397915268182398,     0.0070098865444543955,     0.00664377643657213,     0.006298084298770044,     0.005971435383299221,     0.00566256840323682,     0.005370324502462114,     0.005093637455245601,     0.004831524938258636,     0.004583080748452401,     0.004347467844924636,     0.004123912124633704,     0.00391169683629211,     0.0037101575678913762,     0.0035186777329282446,     0.0033366845067965764,     0.003163645158479496,     0.002999063734042183,     0.00284247805986858,     0.0026934570195705776,     0.002551598090695724,     0.0024165251008331948,     0.0022878861867060172,     0.0021653519397282577,     0.002048613707454106,     0.0019373820464619273,     0.0018313853103441575,     0.0017303683518956562,     0.0016340913362798122,     0.0015423286540555098,     0.0014548679232323956,     0.001371509067434322,     0.0012920634719953271,     0.0012163532059487005,     0.0011442103047788017,     0.0010754761087570428,     0.0010100006495197549,     0.0009476420857138404,     0.000888266180028888,     0.0008317458147698613,     0.0007779605428378728,     0.000726796171172532,     0.0006781443739799577,     0.0006319023333137112,     0.0005879724047946236,     0.0005462618064523957,     0.0005066823288493557,     0.00046915006480686576,     0.0004335851571994606,     0.00039991156341246347,     0.0003680568347950445,     0.0003379519066867227,     0.00030953091057383527,     0.00028273099268654475,     0.0002574921414324234,     0.00023375701739031346,     0.0002114708219241536,     0.00019058113997674233,     0.00017103779980446817,     0.00015279276587253863,     0.00013579998459398583,     0.00012001529624661094,     0.00010539630196571649,     9.190225065961285e-05,     7.949394466300957e-05,     6.813361998816154e-05,     5.778483091657827e-05,     4.841233954980865e-05,     3.998199138566115e-05,     3.246057862360027e-05,     2.5815666623632176e-05,     2.0015433240935637e-05,     1.5028391465324231e-05,     1.0823093070969042e-05,     7.367629336428769e-06,     4.628925854428805e-06,     2.571477779001723e-06,     1.155016009156483e-06,     3.2914933466327955e-07,     1.641236033572888e-08 
    );
    //The first 2 rows of the V matrix:
    float V1[257] = float[](
        -7.557296412354437e-09,     -7.876148544472272e-08,     -2.3117979594533544e-07,     -4.6914155456999817e-07,     -7.962351863561862e-07,     -1.2158569096862438e-06,     -1.731371924239848e-06,     -2.3461842283002813e-06,     -3.063775668624993e-06,     -3.887729909453448e-06,     -4.8217509770792015e-06,     -5.8696769269771874e-06,     -7.035493221369101e-06,     -8.32334364256866e-06,     -9.737541866572901e-06,     -1.1282582589143624e-05,     -1.2963152830739818e-05,     -1.4784143428122583e-05,     -1.675066119435676e-05,     -1.8868041776592923e-05,     -2.1141862578623268e-05,     -2.3577956813496548e-05,     -2.6182428763773636e-05,     -2.8961668826155642e-05,     -3.192237094480087e-05,     -3.50715499102167e-05,     -3.841656043443153e-05,     -4.196511771211514e-05,     -4.5725318579659e-05,     -4.970566483964984e-05,     -5.3915088032234884e-05,     -5.836297591131254e-05,     -6.305920069598286e-05,     -6.8014149592652e-05,     -7.323875747411808e-05,     -7.874454198128653e-05,     -8.454364126638527e-05,     -9.064885460838047e-05,     -9.707368615411205e-05,     -0.00010383239206403147,     -0.00011094003136964141,     -0.00011841252088117427,     -0.0001262666945191015,     -0.00013452036748220803,     -0.00014319240570872589,     -0.00015230280113599765,     -0.00016187275331635477,     -0.00017192475799399602,     -0.00018248270342032422,     -0.00019357197505639277,     -0.00020521956957680033,     -0.00021745421912632273,     -0.00023030652687741122,     -0.00024380911520966274,     -0.00025799678763455933,     -0.0002729067060756499,     -0.00028857858522984283,     -0.0003050549059290988,     -0.00032238114944675174,     -0.0003406060553522711,     -0.00035978190569166196,     -0.0003799648383069184,     -0.00040121519309561254,     -0.00042359789510504364,     -0.0004471828788389687,     -0.000472045559299113,     -0.0004982673553056519,     -0.0005259362721790804,     -0.0005551475514238468,     -0.000586004396369618,     -0.0006186187842269654,     -0.0006531123762904271,     -0.0006896175403573818,     -0.0007282785011662974,     -0.0007692526377838273,     -0.000812711949530668,     -0.0008588447161577481,     -0.000907857382078772,     -0.0009599767000016143,     -0.0010154521755436814,     -0.0010745588620684758,     -0.0011376005643728292,     -0.00120491352088464,     -0.0012768706479492937,     -0.0013538864463342852,     -0.0014364226907244448,     -0.0015249950483367093,     -0.0016201808040860618,     -0.0017226279088993323,     -0.0018330656165747238,     -0.0019523170359852565,     -0.0020813140030855343,     -0.00222111477577911,     -0.0023729251807998526,     -0.0025381240039874767,     -0.0027182936253321,     -0.0029152571739400925,     -0.0031311238375717997,     -0.0033683444370758305,     -0.0036297800105031834,     -0.003918787005245081,     -0.004239323835276013,     -0.004596085148845014,     -0.004994672351370339,     -0.005441812007524961,     -0.0059456381081464844,     -0.006516060443573333,     -0.0071652504193863015,     -0.007908289063681377,     -0.00876404206880742,     -0.009756357324566223,     -0.010915727903530258,     -0.012281638652115795,     -0.013905936175421336,     -0.015857763491345746,     -0.01823094319815145,     -0.021155292334059047,     -0.024814434156073963,     -0.0294746942080659,     -0.035533591965878894,     -0.043604367113415525,     -0.05466967458531236,     -0.07037409178092931,     -0.09360645519545911,     -0.12969481008408545,     -0.18875897933945018,     -0.28852141207015103,     -0.44002348591634527,     -0.5426946241198755,     -0.44002348591634527,     -0.28852141207015103,     -0.18875897933945018,     -0.12969481008408545,     -0.09360645519545911,     -0.07037409178092931,     -0.05466967458531236,     -0.043604367113415525,     -0.035533591965878894,     -0.0294746942080659,     -0.024814434156073963,     -0.021155292334059047,     -0.01823094319815145,     -0.015857763491345746,     -0.013905936175421336,     -0.012281638652115795,     -0.010915727903530258,     -0.009756357324566223,     -0.00876404206880742,     -0.007908289063681377,     -0.0071652504193863015,     -0.006516060443573333,     -0.0059456381081464844,     -0.005441812007524961,     -0.004994672351370339,     -0.004596085148845014,     -0.004239323835276013,     -0.003918787005245081,     -0.0036297800105031834,     -0.0033683444370758305,     -0.0031311238375717997,     -0.0029152571739400925,     -0.0027182936253321,     -0.0025381240039874767,     -0.0023729251807998526,     -0.00222111477577911,     -0.0020813140030855343,     -0.0019523170359852565,     -0.0018330656165747238,     -0.0017226279088993323,     -0.0016201808040860618,     -0.0015249950483367093,     -0.0014364226907244448,     -0.0013538864463342852,     -0.0012768706479492937,     -0.00120491352088464,     -0.0011376005643728292,     -0.0010745588620684758,     -0.0010154521755436814,     -0.0009599767000016143,     -0.000907857382078772,     -0.0008588447161577481,     -0.000812711949530668,     -0.0007692526377838273,     -0.0007282785011662974,     -0.0006896175403573818,     -0.0006531123762904271,     -0.0006186187842269654,     -0.000586004396369618,     -0.0005551475514238468,     -0.0005259362721790804,     -0.0004982673553056519,     -0.000472045559299113,     -0.0004471828788389687,     -0.00042359789510504364,     -0.00040121519309561254,     -0.0003799648383069184,     -0.00035978190569166196,     -0.0003406060553522711,     -0.00032238114944675174,     -0.0003050549059290988,     -0.00028857858522984283,     -0.0002729067060756499,     -0.00025799678763455933,     -0.00024380911520966274,     -0.00023030652687741122,     -0.00021745421912632273,     -0.00020521956957680033,     -0.00019357197505639277,     -0.00018248270342032422,     -0.00017192475799399602,     -0.00016187275331635477,     -0.00015230280113599765,     -0.00014319240570872589,     -0.00013452036748220803,     -0.0001262666945191015,     -0.00011841252088117427,     -0.00011094003136964141,     -0.00010383239206403147,     -9.707368615411205e-05,     -9.064885460838047e-05,     -8.454364126638527e-05,     -7.874454198128653e-05,     -7.323875747411808e-05,     -6.8014149592652e-05,     -6.305920069598286e-05,     -5.836297591131254e-05,     -5.3915088032234884e-05,     -4.970566483964984e-05,     -4.5725318579659e-05,     -4.196511771211514e-05,     -3.841656043443153e-05,     -3.50715499102167e-05,     -3.192237094480087e-05,     -2.8961668826155642e-05,     -2.6182428763773636e-05,     -2.3577956813496548e-05,     -2.1141862578623268e-05,     -1.8868041776592923e-05,     -1.675066119435676e-05,     -1.4784143428122583e-05,     -1.2963152830739818e-05,     -1.1282582589143624e-05,     -9.737541866572901e-06,     -8.32334364256866e-06,     -7.035493221369101e-06,     -5.8696769269771874e-06,     -4.8217509770792015e-06,     -3.887729909453448e-06,     -3.063775668624993e-06,     -2.3461842283002813e-06,     -1.7313719242398478e-06,     -1.215856909686244e-06,     -7.962351863561862e-07,     -4.6914155456992316e-07,     -2.311797959601771e-07,     -7.876148516785817e-08,     -7.557296412354435e-09 
    );
    float V2[257] = float[](
        1.6412360335728894e-08,     3.291493340523699e-07,     1.1550160093909412e-06,     2.57147777896205e-06,     4.628925854429158e-06,     7.3676293364287445e-06,     1.0823093070969005e-05,     1.5028391465324175e-05,     2.001543324093557e-05,     2.581566662363208e-05,     3.246057862360013e-05,     3.9981991385661006e-05,     4.841233954980847e-05,     5.7784830916578043e-05,     6.813361998816124e-05,     7.949394466300925e-05,     9.190225065961247e-05,     0.00010539630196571603,     0.00012001529624661044,     0.00013579998459398526,     0.00015279276587253795,     0.0001710377998044675,     0.0001905811399767416,     0.00021147082192415263,     0.00023375701739031246,     0.0002574921414324223,     0.00028273099268654356,     0.0003095309105738339,     0.00033795190668672105,     0.0003680568347950429,     0.00039991156341246173,     0.0004335851571994586,     0.00046915006480686364,     0.0005066823288493534,     0.0005462618064523932,     0.000587972404794621,     0.0006319023333137083,     0.0006781443739799545,     0.0007267961711725288,     0.0007779605428378693,     0.0008317458147698575,     0.000888266180028884,     0.000947642085713836,     0.00101000064951975,     0.0010754761087570378,     0.0011442103047787963,     0.0012163532059486946,     0.0012920634719953208,     0.0013715090674343156,     0.0014548679232323886,     0.0015423286540555026,     0.0016340913362798044,     0.0017303683518956486,     0.001831385310344149,     0.0019373820464619184,     0.0020486137074540974,     0.002165351939728247,     0.002287886186706007,     0.0024165251008331826,     0.0025515980906957126,     0.0026934570195705663,     0.0028424780598685674,     0.0029990637340421697,     0.003163645158479481,     0.0033366845067965617,     0.0035186777329282294,     0.003710157567891359,     0.003911696836292094,     0.004123912124633684,     0.004347467844924616,     0.00458308074845238,     0.004831524938258613,     0.005093637455245579,     0.005370324502462089,     0.005662568403236794,     0.005971435383299195,     0.006298084298770016,     0.006643776436572101,     0.0070098865444543626,     0.007397915268182369,     0.007809503202646132,     0.008246446803914691,     0.008710716442999396,     0.009204476941051197,     0.009730110978413607,     0.010290245845433124,     0.010887784090168799,     0.011525938719620925,     0.01220827374196752,     0.012938750989982295,     0.013721784354352878,     0.014562302789070912,     0.015465823734641098,     0.016438538956733473,     0.01748741523488618,     0.0186203128779346,     0.01984612572048419,     0.021174947104290655,     0.02261826741735932,     0.024189210112175022,     0.025902814832948172,     0.027776378450663743,     0.02982986756410699,     0.03208641953840397,     0.034572953623856116,     0.03732091937034088,     0.04036721670080478,     0.04375533089952847,     0.04753673657469991,     0.05177263721596938,     0.05653612031748724,     0.06191481932057253,     0.06801417578275772,     0.0749613718642116,     0.08290991765996454,     0.09204464777122782,     0.10258632112601632,     0.11479370143145634,     0.12895792087073957,     0.14537666545809735,     0.16427814596067775,     0.18562088920206377,     0.20858135144799123,     0.2302348061041235,     0.24210412265426767,     0.22124982984721098,     0.11154807909064735,     -0.1654122670094351,     -0.40263228205694107,     -0.1654122670094351,     0.11154807909064735,     0.22124982984721098,     0.24210412265426767,     0.2302348061041235,     0.20858135144799123,     0.18562088920206377,     0.16427814596067775,     0.14537666545809735,     0.12895792087073957,     0.11479370143145634,     0.10258632112601632,     0.09204464777122782,     0.08290991765996454,     0.0749613718642116,     0.06801417578275772,     0.06191481932057253,     0.05653612031748724,     0.05177263721596938,     0.04753673657469991,     0.04375533089952847,     0.04036721670080478,     0.03732091937034088,     0.034572953623856116,     0.03208641953840397,     0.02982986756410699,     0.027776378450663743,     0.025902814832948172,     0.024189210112175022,     0.02261826741735932,     0.021174947104290655,     0.01984612572048419,     0.0186203128779346,     0.01748741523488618,     0.016438538956733473,     0.015465823734641098,     0.014562302789070912,     0.013721784354352878,     0.012938750989982295,     0.01220827374196752,     0.011525938719620925,     0.010887784090168799,     0.010290245845433124,     0.009730110978413607,     0.009204476941051197,     0.008710716442999396,     0.008246446803914691,     0.007809503202646132,     0.007397915268182369,     0.0070098865444543626,     0.006643776436572101,     0.006298084298770016,     0.005971435383299195,     0.005662568403236794,     0.005370324502462089,     0.005093637455245579,     0.004831524938258613,     0.00458308074845238,     0.004347467844924616,     0.004123912124633684,     0.003911696836292094,     0.003710157567891359,     0.0035186777329282294,     0.0033366845067965617,     0.003163645158479481,     0.0029990637340421697,     0.0028424780598685674,     0.0026934570195705663,     0.0025515980906957126,     0.0024165251008331826,     0.002287886186706007,     0.002165351939728247,     0.0020486137074540974,     0.0019373820464619184,     0.001831385310344149,     0.0017303683518956486,     0.0016340913362798044,     0.0015423286540555026,     0.0014548679232323886,     0.0013715090674343156,     0.0012920634719953208,     0.0012163532059486946,     0.0011442103047787963,     0.0010754761087570378,     0.00101000064951975,     0.000947642085713836,     0.000888266180028884,     0.0008317458147698575,     0.0007779605428378693,     0.0007267961711725288,     0.0006781443739799545,     0.0006319023333137083,     0.000587972404794621,     0.0005462618064523932,     0.0005066823288493534,     0.00046915006480686364,     0.0004335851571994586,     0.00039991156341246173,     0.0003680568347950429,     0.00033795190668672105,     0.0003095309105738339,     0.00028273099268654356,     0.0002574921414324223,     0.00023375701739031246,     0.00021147082192415263,     0.0001905811399767416,     0.0001710377998044675,     0.00015279276587253795,     0.00013579998459398526,     0.00012001529624661044,     0.00010539630196571603,     9.190225065961247e-05,     7.949394466300925e-05,     6.813361998816124e-05,     5.7784830916578043e-05,     4.841233954980847e-05,     3.9981991385661006e-05,     3.246057862360013e-05,     2.581566662363208e-05,     2.001543324093557e-05,     1.5028391465324175e-05,     1.0823093070969005e-05,     7.3676293364287445e-06,     4.628925854428792e-06,     2.5714777790017168e-06,     1.1550160091564806e-06,     3.291493346632791e-07,     1.64123603357289e-08 
    );
    //The first 2 singular values:
    float S[2] = float[](
        0.045983058370594285,     0.007889879937601593 
    );
    //center of the convolution
    int Nc = 128;

    //do a convolution in the y direction on iChannel0
    vec3 sum1 = vec3(0.0);
    vec3 sum2 = vec3(0.0);
    ivec2 coord = ivec2(fragCoord);
    for (int i = -Nc; i < Nc; i++) 
    {
        //use texelFetch to get the pixel at the current index
        vec4 pixel = texelFetch(iChannel0, ivec2(coord.x, coord.y + 1), 0);
        
        vec3 val1, val2;
        unpack2vec3(pixel.xyz, val1, val2);

        sum1 += val1 * V1[i + Nc] * S[0];
        sum2 += val2 * V2[i + Nc] * S[1];
    }

    //return the sum
    vec3 result = sum1 + sum2;
    fragColor = vec4(result, 1.0);
}


